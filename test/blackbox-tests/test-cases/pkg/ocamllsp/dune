(cram
 (setup_scripts helpers.sh)
 (applies_to :whole_subtree))

;; flaky https://github.com/ocaml/dune/actions/runs/15262698269/job/42923225446

(cram
 (applies_to dev-tool-ocamllsp-install-concurrent-with-watch-server)
 (enabled_if false))

;; issues with dev tool lock dirs in source

(cram
 (applies_to
  dev-tool-ocamllsp-ocamlformat
  dev-tool-ocamllsp-no-lock-dir
  dev-tool-ocamllsp-no-ocaml-lockfile)
 (enabled_if false))

(rule
 (alias runtest)
 (deps helpers.sh)
 (action
  (run %{bin:bash} -n %{deps})))

(rule
 (alias runtest)
 (enabled_if %{bin-available:shellcheck})
 (deps helpers.sh)
 (action
  (run %{bin:shellcheck} -s bash %{deps})))
